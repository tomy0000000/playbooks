# https://nginxproxymanager.com/setup/
---
- hosts: all
  vars:
    service_dir: "Developing/nginx-proxy-manager"

  tasks:
    - name: Create service directory
      ansible.builtin.file:
        path: "{{ service_dir }}"
        state: directory

    - name: Create 'nginx-proxy-manager' network
      community.docker.docker_network:
        name: nginx-proxy-manager

    - name: Create docker-compose.yml
      ansible.builtin.copy:
        src: ./docker-compose.yml
        dest: "{{ service_dir }}/docker-compose.yml"

    - name: Pull images
      ansible.builtin.command:
        chdir: "{{ service_dir }}"
        cmd: docker compose pull

    - name: Start services
      ansible.builtin.command:
        chdir: "{{ service_dir }}"
        cmd: docker compose up --detach
